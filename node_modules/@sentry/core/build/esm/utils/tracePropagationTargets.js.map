{"version":3,"file":"tracePropagationTargets.js","sources":["../../../src/utils/tracePropagationTargets.ts"],"sourcesContent":["import { DEBUG_BUILD } from '../debug-build';\nimport type { CoreOptions as Options } from '../types-hoist/options';\nimport { debug } from './debug-logger';\nimport type { LRUMap } from './lru';\nimport { stringMatchesSomePattern } from './string';\n\nconst NOT_PROPAGATED_MESSAGE =\n  '[Tracing] Not injecting trace data for url because it does not match tracePropagationTargets:';\n\n/**\n * Check if a given URL should be propagated to or not.\n * If no url is defined, or no trace propagation targets are defined, this will always return `true`.\n * You can also optionally provide a decision map, to cache decisions and avoid repeated regex lookups.\n */\nexport function shouldPropagateTraceForUrl(\n  url: string | undefined,\n  tracePropagationTargets: Options['tracePropagationTargets'],\n  decisionMap?: LRUMap<string, boolean>,\n): boolean {\n  if (typeof url !== 'string' || !tracePropagationTargets) {\n    return true;\n  }\n\n  const cachedDecision = decisionMap?.get(url);\n  if (cachedDecision !== undefined) {\n    DEBUG_BUILD && !cachedDecision && debug.log(NOT_PROPAGATED_MESSAGE, url);\n    return cachedDecision;\n  }\n\n  const decision = stringMatchesSomePattern(url, tracePropagationTargets);\n  decisionMap?.set(url, decision);\n\n  DEBUG_BUILD && !decision && debug.log(NOT_PROPAGATED_MESSAGE, url);\n  return decision;\n}\n"],"names":[],"mappings":";;;;AAMA,MAAM,sBAAA;AACN,EAAE,+FAA+F;;AAEjG;AACA;AACA;AACA;AACA;AACO,SAAS,0BAA0B;AAC1C,EAAE,GAAG;AACL,EAAE,uBAAuB;AACzB,EAAE,WAAW;AACb,EAAW;AACX,EAAE,IAAI,OAAO,GAAA,KAAQ,QAAA,IAAY,CAAC,uBAAuB,EAAE;AAC3D,IAAI,OAAO,IAAI;AACf,EAAE;;AAEF,EAAE,MAAM,iBAAiB,WAAW,EAAE,GAAG,CAAC,GAAG,CAAC;AAC9C,EAAE,IAAI,cAAA,KAAmB,SAAS,EAAE;AACpC,IAAI,WAAA,IAAe,CAAC,cAAA,IAAkB,KAAK,CAAC,GAAG,CAAC,sBAAsB,EAAE,GAAG,CAAC;AAC5E,IAAI,OAAO,cAAc;AACzB,EAAE;;AAEF,EAAE,MAAM,WAAW,wBAAwB,CAAC,GAAG,EAAE,uBAAuB,CAAC;AACzE,EAAE,WAAW,EAAE,GAAG,CAAC,GAAG,EAAE,QAAQ,CAAC;;AAEjC,EAAE,WAAA,IAAe,CAAC,QAAA,IAAY,KAAK,CAAC,GAAG,CAAC,sBAAsB,EAAE,GAAG,CAAC;AACpE,EAAE,OAAO,QAAQ;AACjB;;;;"}