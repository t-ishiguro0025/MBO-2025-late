{"version":3,"file":"makeCustomSentryVitePlugins.js","sources":["../../../src/vite/makeCustomSentryVitePlugins.ts"],"sourcesContent":["import { sentryVitePlugin } from '@sentry/vite-plugin';\nimport { type Plugin } from 'vite';\nimport type { SentryReactRouterBuildOptions } from './types';\n\n/**\n * Create a custom subset of sentry's vite plugins\n */\nexport async function makeCustomSentryVitePlugins(options: SentryReactRouterBuildOptions): Promise<Plugin[]> {\n  const {\n    debug,\n    unstable_sentryVitePluginOptions,\n    bundleSizeOptimizations,\n    authToken,\n    org,\n    project,\n    telemetry,\n    reactComponentAnnotation,\n    release,\n  } = options;\n\n  const sentryVitePlugins = sentryVitePlugin({\n    authToken: authToken ?? process.env.SENTRY_AUTH_TOKEN,\n    bundleSizeOptimizations,\n    debug: debug ?? false,\n    org: org ?? process.env.SENTRY_ORG,\n    project: project ?? process.env.SENTRY_PROJECT,\n    telemetry: telemetry ?? true,\n    _metaOptions: {\n      telemetry: {\n        metaFramework: 'react-router',\n      },\n      ...unstable_sentryVitePluginOptions?._metaOptions,\n    },\n    reactComponentAnnotation: {\n      enabled: reactComponentAnnotation?.enabled ?? undefined,\n      ignoredComponents: reactComponentAnnotation?.ignoredComponents ?? undefined,\n      ...unstable_sentryVitePluginOptions?.reactComponentAnnotation,\n    },\n    release: {\n      ...unstable_sentryVitePluginOptions?.release,\n      ...release,\n    },\n    // will be handled in buildEnd hook\n    sourcemaps: {\n      disable: true,\n      ...unstable_sentryVitePluginOptions?.sourcemaps,\n    },\n    ...unstable_sentryVitePluginOptions,\n  }) as Plugin[];\n\n  // only use a subset of the plugins as all upload and file deletion tasks will be handled in the buildEnd hook\n  return [\n    ...sentryVitePlugins.filter(plugin => {\n      return [\n        'sentry-telemetry-plugin',\n        'sentry-vite-injection-plugin',\n        ...(reactComponentAnnotation?.enabled || unstable_sentryVitePluginOptions?.reactComponentAnnotation?.enabled\n          ? ['sentry-vite-component-name-annotate-plugin']\n          : []),\n      ].includes(plugin.name);\n    }),\n  ];\n}\n"],"names":[],"mappings":";;AAIA;AACA;AACA;AACO,eAAe,2BAA2B,CAAC,OAAO,EAAoD;AAC7G,EAAE,MAAM;AACR,IAAI,KAAK;AACT,IAAI,gCAAgC;AACpC,IAAI,uBAAuB;AAC3B,IAAI,SAAS;AACb,IAAI,GAAG;AACP,IAAI,OAAO;AACX,IAAI,SAAS;AACb,IAAI,wBAAwB;AAC5B,IAAI,OAAO;AACX,GAAE,GAAI,OAAO;;AAEb,EAAE,MAAM,iBAAA,GAAoB,gBAAgB,CAAC;AAC7C,IAAI,SAAS,EAAE,SAAA,IAAa,OAAO,CAAC,GAAG,CAAC,iBAAiB;AACzD,IAAI,uBAAuB;AAC3B,IAAI,KAAK,EAAE,KAAA,IAAS,KAAK;AACzB,IAAI,GAAG,EAAE,GAAA,IAAO,OAAO,CAAC,GAAG,CAAC,UAAU;AACtC,IAAI,OAAO,EAAE,OAAA,IAAW,OAAO,CAAC,GAAG,CAAC,cAAc;AAClD,IAAI,SAAS,EAAE,SAAA,IAAa,IAAI;AAChC,IAAI,YAAY,EAAE;AAClB,MAAM,SAAS,EAAE;AACjB,QAAQ,aAAa,EAAE,cAAc;AACrC,OAAO;AACP,MAAM,GAAG,gCAAgC,EAAE,YAAY;AACvD,KAAK;AACL,IAAI,wBAAwB,EAAE;AAC9B,MAAM,OAAO,EAAE,wBAAwB,EAAE,OAAA,IAAW,SAAS;AAC7D,MAAM,iBAAiB,EAAE,wBAAwB,EAAE,iBAAA,IAAqB,SAAS;AACjF,MAAM,GAAG,gCAAgC,EAAE,wBAAwB;AACnE,KAAK;AACL,IAAI,OAAO,EAAE;AACb,MAAM,GAAG,gCAAgC,EAAE,OAAO;AAClD,MAAM,GAAG,OAAO;AAChB,KAAK;AACL;AACA,IAAI,UAAU,EAAE;AAChB,MAAM,OAAO,EAAE,IAAI;AACnB,MAAM,GAAG,gCAAgC,EAAE,UAAU;AACrD,KAAK;AACL,IAAI,GAAG,gCAAgC;AACvC,GAAG,CAAA;;AAEH;AACA,EAAE,OAAO;AACT,IAAI,GAAG,iBAAiB,CAAC,MAAM,CAAC,UAAU;AAC1C,MAAM,OAAO;AACb,QAAQ,yBAAyB;AACjC,QAAQ,8BAA8B;AACtC,QAAQ,IAAI,wBAAwB,EAAE,WAAW,gCAAgC,EAAE,wBAAwB,EAAE;AAC7G,YAAY,CAAC,4CAA4C;AACzD,YAAY,EAAE,CAAC;AACf,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC;AAC7B,IAAI,CAAC,CAAC;AACN,GAAG;AACH;;;;"}