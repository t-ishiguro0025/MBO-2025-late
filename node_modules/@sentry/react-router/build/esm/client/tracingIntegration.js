import { browserTracingIntegration } from '@sentry/browser';
import { createSentryClientInstrumentation } from './createClientInstrumentation.js';
import { instrumentHydratedRouter } from './hydratedRouter.js';

/**
 * Options for the React Router tracing integration.
 */

/**
 * Browser tracing integration for React Router (Framework) applications.
 * This integration will create navigation spans and enhance transaction names with parameterized routes.
 */
function reactRouterTracingIntegration(
  options = {},
) {
  const browserTracingIntegrationInstance = browserTracingIntegration({
    // Navigation transactions are started within the hydrated router instrumentation
    instrumentNavigation: false,
  });

  let clientInstrumentationInstance;

  if (options.useInstrumentationAPI || options.instrumentationOptions) {
    clientInstrumentationInstance = createSentryClientInstrumentation(options.instrumentationOptions);
  }

  const getClientInstrumentation = () => {
    if (!clientInstrumentationInstance) {
      clientInstrumentationInstance = createSentryClientInstrumentation(options.instrumentationOptions);
    }
    return clientInstrumentationInstance;
  };

  return {
    ...browserTracingIntegrationInstance,
    name: 'ReactRouterTracingIntegration',
    afterAllSetup(client) {
      browserTracingIntegrationInstance.afterAllSetup(client);
      instrumentHydratedRouter();
    },
    get clientInstrumentation() {
      return getClientInstrumentation();
    },
  };
}

export { reactRouterTracingIntegration };
//# sourceMappingURL=tracingIntegration.js.map
