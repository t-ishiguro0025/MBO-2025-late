{"version":3,"file":"tracingIntegration.js","sources":["../../../src/client/tracingIntegration.ts"],"sourcesContent":["import { browserTracingIntegration as originalBrowserTracingIntegration } from '@sentry/browser';\nimport type { Integration } from '@sentry/core';\nimport type { ClientInstrumentation } from '../common/types';\nimport {\n  createSentryClientInstrumentation,\n  type CreateSentryClientInstrumentationOptions,\n} from './createClientInstrumentation';\nimport { instrumentHydratedRouter } from './hydratedRouter';\n\n/**\n * Options for the React Router tracing integration.\n */\nexport interface ReactRouterTracingIntegrationOptions {\n  /**\n   * Options for React Router's instrumentation API.\n   * @experimental\n   */\n  instrumentationOptions?: CreateSentryClientInstrumentationOptions;\n\n  /**\n   * Enable React Router's instrumentation API.\n   * When true, prepares for use with HydratedRouter's `unstable_instrumentations` prop.\n   * @experimental\n   * @default false\n   */\n  useInstrumentationAPI?: boolean;\n}\n\n/**\n * React Router tracing integration with support for the instrumentation API.\n */\nexport interface ReactRouterTracingIntegration extends Integration {\n  /**\n   * Client instrumentation for React Router's instrumentation API.\n   * Lazily initialized on first access.\n   * @experimental HydratedRouter doesn't invoke these hooks in Framework Mode yet.\n   */\n  readonly clientInstrumentation: ClientInstrumentation;\n}\n\n/**\n * Browser tracing integration for React Router (Framework) applications.\n * This integration will create navigation spans and enhance transaction names with parameterized routes.\n */\nexport function reactRouterTracingIntegration(\n  options: ReactRouterTracingIntegrationOptions = {},\n): ReactRouterTracingIntegration {\n  const browserTracingIntegrationInstance = originalBrowserTracingIntegration({\n    // Navigation transactions are started within the hydrated router instrumentation\n    instrumentNavigation: false,\n  });\n\n  let clientInstrumentationInstance: ClientInstrumentation | undefined;\n\n  if (options.useInstrumentationAPI || options.instrumentationOptions) {\n    clientInstrumentationInstance = createSentryClientInstrumentation(options.instrumentationOptions);\n  }\n\n  const getClientInstrumentation = (): ClientInstrumentation => {\n    if (!clientInstrumentationInstance) {\n      clientInstrumentationInstance = createSentryClientInstrumentation(options.instrumentationOptions);\n    }\n    return clientInstrumentationInstance;\n  };\n\n  return {\n    ...browserTracingIntegrationInstance,\n    name: 'ReactRouterTracingIntegration',\n    afterAllSetup(client) {\n      browserTracingIntegrationInstance.afterAllSetup(client);\n      instrumentHydratedRouter();\n    },\n    get clientInstrumentation(): ClientInstrumentation {\n      return getClientInstrumentation();\n    },\n  };\n}\n"],"names":["originalBrowserTracingIntegration","createSentryClientInstrumentation","instrumentHydratedRouter"],"mappings":";;;;;;AASA;AACA;AACA;;AA6BA;AACA;AACA;AACA;AACO,SAAS,6BAA6B;AAC7C,EAAE,OAAO,GAAyC,EAAE;AACpD,EAAiC;AACjC,EAAE,MAAM,iCAAA,GAAoCA,iCAAiC,CAAC;AAC9E;AACA,IAAI,oBAAoB,EAAE,KAAK;AAC/B,GAAG,CAAC;;AAEJ,EAAE,IAAI,6BAA6B;;AAEnC,EAAE,IAAI,OAAO,CAAC,yBAAyB,OAAO,CAAC,sBAAsB,EAAE;AACvE,IAAI,gCAAgCC,6DAAiC,CAAC,OAAO,CAAC,sBAAsB,CAAC;AACrG,EAAE;;AAEF,EAAE,MAAM,wBAAA,GAA2B,MAA6B;AAChE,IAAI,IAAI,CAAC,6BAA6B,EAAE;AACxC,MAAM,gCAAgCA,6DAAiC,CAAC,OAAO,CAAC,sBAAsB,CAAC;AACvG,IAAI;AACJ,IAAI,OAAO,6BAA6B;AACxC,EAAE,CAAC;;AAEH,EAAE,OAAO;AACT,IAAI,GAAG,iCAAiC;AACxC,IAAI,IAAI,EAAE,+BAA+B;AACzC,IAAI,aAAa,CAAC,MAAM,EAAE;AAC1B,MAAM,iCAAiC,CAAC,aAAa,CAAC,MAAM,CAAC;AAC7D,MAAMC,uCAAwB,EAAE;AAChC,IAAI,CAAC;AACL,IAAI,IAAI,qBAAqB,GAA0B;AACvD,MAAM,OAAO,wBAAwB,EAAE;AACvC,IAAI,CAAC;AACL,GAAG;AACH;;;;"}